# 에이전트에 도구 추가#1 (MCP 커넥터)

## ✅ Copilot Studio에서 도구(Tool)의 역할

**도구(Tool)** 는 Copilot이 기본적으로 할 수 없는 기능을 확장해주는 **추가 능력**입니다.  
쉽게 말해, **Copilot을 단순한 대화형 AI에서 ‘업무 실행형 AI’로 업그레이드하는 핵심 요소**입니다.

---

## **1. 도구의 핵심 역할**
|역할|설명|
|------|---|
|외부 서비스 연결|CRM, ERP, 데이터베이스, API 호출|
|업무 자동화|이메일 전송, 일정 생성, 보고서 작성|
|데이터 처리|Excel 분석, PDF 요약, 데이터 변환|
|시스템 통합|Microsoft 365, Teams, Power Automate 연동|

---

## **2. 왜 필요한가?**


- Copilot은 기본적으로 **대화형 AI** → 데이터 조회나 시스템 명령 실행은 불가능  
- **도구를 연결하면 Copilot이 실제 작업을 실행**할 수 있음  

---

## **3. 예시로 이해하기**

- **도구 없음**  
  > “이번 주 매출 알려줘”  
  → Copilot: “제가 직접 데이터에 접근할 수 없어요.”

- **도구 연결**  
  > “이번 주 매출 알려줘”  
  → Copilot: (ERP API 호출) → “이번 주 매출은 **₩120,000,000**입니다.”

---

## **4. 정리**


✔ 도구는 **Copilot의 기능을 확장**하는 핵심  
✔ **업무 자동화 + 데이터 연결 + 시스템 통합** 가능  
✔ **실제 비즈니스 프로세스 실행**을 가능하게 함  

---
<br> <br> <br> 

## 실습

이번 실습에서는 에이전트가 사용자를 대신하여 생성된 블로그/뉴스레터 초안을 메일로 발송해주기 위한 도구를 추가해보도록 합니다.

### 1. 메일 발송 도구 추가
에이전트 설정창에서 [도구] - [+ 도구 추가] 를 선택합니다.
<img width="970" height="589" alt="image" src="https://github.com/user-attachments/assets/4ff4e0b4-8fd1-4bb0-9c79-9097c94156ff" />

모던 컨텍스트 프로토콜에서 "이메일 관리 MCP 서버"를 선택합니다. 
<img width="543" height="396" alt="image" src="https://github.com/user-attachments/assets/9d324745-f91b-4588-9729-df8fa9cb315e" />

도구를 선택하면, Office 365 outlook 커넥터를 이용하기 위한 OAuth 연결 창이 뜨며, <br>
[새 연결 만들기]를 통해 접속한 계정의 로그인 정보를 입력후 만들기를 클릭합니다. <br>
<img width="548" height="406" alt="image" src="https://github.com/user-attachments/assets/d4260866-c5ea-48fb-aaad-3a9d9f2552ec" />
<br> 
<img width="1022" height="738" alt="image" src="https://github.com/user-attachments/assets/599eb77c-27b3-4ca8-834e-47078913cd4d" />
<br> <br> 
연결이 완료되면 아래 화면과 같이 연결된 계정 정보와 초록색 아이콘이 표시됩니다. <br> 
[추가 및 구성] 을 선택하여, 메일 발송 커넥터의 상세 설정으로 이동합니다. <br> 
<img width="1044" height="768" alt="image" src="https://github.com/user-attachments/assets/a669d0f8-228c-429f-88d2-93c7351db777" />
<br> 
<br> 
<br> 
## 2. 메일 발송 커넥터 기본 설정
다음은 Agent가 메일을 발송하기 위해 필요한 설정들을 지정합니다.<br> 

기본적으로 도구가 추가되면 가장 먼저 해야하는 작업은 **설명** 란에 이 도구가 언제, 어떻게 사용되는지를 입력합니다. <br> 

이 설명은 Agent가 도구를 선택해야할 때 참조하는 설명으로 상황이 최대한 자세하게 설명되어 있어야 정확한 지시에 맞추어 동작합니다.<br> 

다만, 추가한 MCP 서버의 경우 이미 MCP 서버단에서 서버의 설명과 각 도구의 설명들을 미리 작성을하여 업데이트가 된 상태이기 때문에 별도의 설명을 추가하는 작업을 하지 않아도 됩니다.<br> 
<br> 
<br> 
다음으로 추가 세부 정보창을 열어 인증 정책을 **[제작자 제공 자격 증명]** 으로 변경합니다.
<img width="1056" height="694" alt="image" src="https://github.com/user-attachments/assets/e9ab862e-b6bf-473b-969f-bf1e92c9c5c6" />

기본적으로 "최종 사용자 자격 증명" 으로 선택되어 있으며, 이 경우 에이전트를 사용하는 사용자가 액션을 이용할 때 로그인 절차를 1회 거치게 되어있습니다.

사용자의 권한으로 메일박스를 검색하거나, 데이터를 조회해야할 경우 그대로 유지하고
특정 시스템에 접근이 가능한 계정이 한정되어 있을 경우(예, SAP, DB 접근 등) 
제작자 제공 자격 증명으로 변경하여 사용자들이 로그인을 하지 않더라도 데이터 접근이 가능토록 구성합니다.

---
## 3. 메일 관리 MCP 서버 사용 도구 설정

MCP서버에서 제공되는 도구들 중, 실제로 사용할 도구들만 활성화 시키는 작업을 합니다. <br>
이작업은 옵션이나, 지침에 정의되지 않은 도구들이 있을 경우, Agent가 도구를 선택함에 있어 정확도를 낮출수 있기 떄문에 가급적 필요한 도구만 활성화 시키도록 합니다.

도구에서 기능 전체 기능 활성화 옵션을 끄게되면, 각각의 도구들만 선택적으로 허용할 수 있습니다. <br>
이번 시나리오에서는 메일 발송만 필요하기 때문에 SendEmail 도구 이외에 다른 기능은 모두 비활성화 처리 합니다. <br>
<img width="1055" height="980" alt="image" src="https://github.com/user-attachments/assets/fc646c29-01d3-45bb-a25f-9c8670385adf" />

이후 상단의 **저장** 버튼을 클릭하면 이메일 발송도구가 준비되었으며,
다음은 에이전트가 메일을 발송할 때, 어떻게 보내야하는지에 대한 지침을 작성하도록 합니다.


## 4. 에이전트 지침 수정
메일 발송 도구 설정이 완료되었으나, 
'사용자가 메일을 발송해줘' 라고 입력을 할 경우 도구가 선택하여 동작을 하겠지만
담당자가 누구인지, 제목을 어떻게 해야하는지, 본문은 무엇을 입력해야하는지와 같은 상세 지침이 지정되어 있지 않습니다.

따라서, 다시 **개요**로 돌아가, 추가된 도구에 대한 지침을 입력해 주도록 합니다.

<img width="1094" height="828" alt="image" src="https://github.com/user-attachments/assets/0e13eae5-14b5-4374-9788-b815e090596e" />


지침 내 1) 지원 능력 파트아래에 추가
```
### 1.6 메일 발송(send a mail)
- 작성된 블로그 초안을 메일 뉴스레터로 발송합니다
- Subject는 사용자에게 질의하여 메일 뉴스레터 제목을 받습니다
- To는 사용자에게 질의하여 메일주소를 입력 받습니다
- 중요! Body에는 HTML, CSS 스타일을 적용하여 레이아웃과 디자인을 적용합니다

```
지침 내 3) 예시 워크플로우(원문 시나리오 포함) 에 추가
```
사용자: "이 내용으로 메일을 보내줘"
에이전트: "네 해당 내용을 HTML과 CSS 스타일을 적용하여 메일을 발송하겠습니다."
```
지침 하단에 추가
```
## 8) 메일 발송 형식 가이드
 - to: 수신자, mail address를 입력
 - subject: 메일 제목, 본문 내용을 요약하여 메일 제목 초안을 작성하여 사용자에 제시하되, 사용자에게 질의를 하여 메일 제목을 작성. 
 - body: 메일 본문이며, HTML과 CSS 스타일 형식을 적용하여 디자인적 요소를 추가하여 본문을 작성

---
```
지침 편집을 마치고 저장을 한 후, 테스트를 하여 메일이 정상적으로 발송되는지 확인해 봅니다.
테스트 프롬프트
```
식기세척기 제품군들에 대해 뉴스레터를 만들어서 **[메일 주소]** 에게 메일로 보내줘
```
Copilot Studio 테스트 화면
<img width="1704" height="1259" alt="image" src="https://github.com/user-attachments/assets/1b8124ba-fd06-4167-877a-22ab78461c49" />

> 지침에 따라 맞추어 문서 형식과 초안을 만들어 제안후 메일을 발송

메일 수신 화면
<img width="1544" height="1528" alt="image" src="https://github.com/user-attachments/assets/a9879c4f-8caf-47b0-935d-47e89498d4a3" />


---
이로서 도구를 통해 에이전트가 추가적인 액션을 이용할 수 있게 되었습니다. <br>
다음은 동일한 내용으로 팀즈 채널에 메세지를 게시하는 도구를 추가해 보도록 합니다.
